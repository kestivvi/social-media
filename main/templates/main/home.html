{% extends 'main/base.html' %} {% block title %}Home Page{% endblock %} 
{% block content %} {% for post in posts %}
<div class="card shadow mt-2">
  <div class="card-header d-flex flex-row justify-content-between">
    <div><strong>@{{ post.author.username }}</strong></div>
    <div class="text-muted">{{post.created_at}}</div>
  </div>
  <div class="card-body d-flex flex-row justify-content-between" style="align-items: center;">
    <div>
      <h3 class="card-title">{{post.title}}</h3>
      <p class="ml-5">
        {% for line in post.description %}
        {{ line }}<br>
        {% endfor %}
      </p>
    </div>
    <div>
      {% if user == post.author or perms.main.delete_post %}
      <a href="/modify-post/{{ post.id }}">
        <button
          type="submit"
          class="btn btn-outline-secondary"
        >
          Modify
        </button>
      </a>
      <form method="post">
        {% csrf_token %}
        <button
          type="submit"
          class="btn btn-outline-danger"
          name="post-id"
          value="{{post.id}}"
        >
          Delete
        </button>
      </form>
      {% endif %}
      {% if user.is_staff %}
      <form method="post">
        {% csrf_token %}
        <button
          type="submit"
          class="btn btn-outline-warning"
          name="user-id"
          value="{{post.author.id}}"
        >
          Ban User
        </button>
      </form>
      {% endif %}
    </div>
  </div>
  <div class="card-footer">
    <ul class="list-group list-group-flush" style="border-radius: 10px;">
      {% for comment in comments %}
        {% if post.id == comment.post.id %}
          <li class="list-group-item mb-2 mx-2 comment d-flex flex-row justify-content-between" style="align-items: center;">
            <div>
              <strong>@{{ comment.author.username }}</strong>
              <p class="ml-5">
                {% for line in comment.description %}
                {{ line }}<br>
                {% endfor %}
              </p>
            </div>
            <div>
              {% if user == comment.author or user.is_staff %}
              <a href="/modify-comment/{{ comment.id }}" style="display: inline-block">
                <button
                  type="submit"
                  class="btn btn-outline-secondary"
                >
                  Modify
                </button>
              </a>
              <form method="post" style="display: inline-block">
                {% csrf_token %}
                <button
                  type="submit"
                  class="btn btn-outline-danger"
                  name="comment-id"
                  value="{{comment.id}}"
                >
                  Delete
                </button>
              </form>
              {% endif %}
            </div>
          </li>
        {% endif %}
      {% endfor %}
      <form action="/create_comment/{{ post.id }}/" method="post">
        {% csrf_token %}
        <button
          type="submit"
          class="btn btn-outline-primary ml-3"
          name="create-comment"
          value="{{post.id}}"
        >
          Comment
        </button>
      </form>

    </ul>
  </div>
</div>
{% empty %}
<p>No posts yet :(</p>
{% endfor %} {% endblock %}
